const D=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}};D();const I="modulepreload",E={},N="",y=function(i,t){return!t||t.length===0?i():Promise.all(t.map(o=>{if(o=`${N}${o}`,o in E)return;E[o]=!0;const s=o.endsWith(".css"),n=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${n}`))return;const a=document.createElement("link");if(a.rel=s?"stylesheet":I,s||(a.as="script",a.crossOrigin=""),a.href=o,document.head.appendChild(a),s)return new Promise((g,p)=>{a.addEventListener("load",g),a.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>i())};class f{constructor(i,t,o,s=2,n=.001){this.ctx=i,this.x=t||this.ctx.random(this.ctx.width),this.y=o||this.ctx.random(this.ctx.height),this.noiseOffsetX=this.ctx.random(1e3),this.noiseOffsetY=this.ctx.random(1e3),this.speed=s,this.noiseSpeed=n,this.sprite=new i.Sprite(this.x,this.y,20)}move(){this.x+=this.ctx.map(this.ctx.noise(this.noiseOffsetX),0,1,-this.speed,this.speed),this.y+=this.ctx.map(this.ctx.noise(this.noiseOffsetY),0,1,-this.speed,this.speed),this.noiseOffsetX+=this.noiseSpeed,this.noiseOffsetY+=this.noiseSpeed,this.x<0&&(this.x=this.ctx.width),this.x>this.ctx.width&&(this.x=0),this.y<0&&(this.y=this.ctx.height),this.y>this.ctx.height&&(this.y=0)}display(){this.sprite.x=this.x,this.sprite.y=this.y}touches(i){return this.ctx.dist(this.x,this.y,i.x,i.y)<20}proximityTo(i){return this.ctx.dist(this.x,this.y,i.x,i.y)}}class b extends f{constructor(i,t,o,s,n){super(i,t,o,null,null),this.livesMax=s,this.reset(),this.x=t||this.x,this.y=o||this.y,this.invulnerable=!1,this.sprites={normal:n.normal,invulnerable:n.invuln},this.setSprite(this.sprites.normal)}setSprite(i){this.sprite.image=i,this.sprite.image.width=20,this.sprite.image.height=20}reset(){this.x=this.ctx.width/2,this.y=this.ctx.height/2,this.lives=this.livesMax,this.invulnerable=!1}move(){this.ctx.keyIsDown(this.ctx.LEFT_ARROW)&&(this.x-=5),this.ctx.keyIsDown(this.ctx.RIGHT_ARROW)&&(this.x+=5),this.ctx.keyIsDown(this.ctx.UP_ARROW)&&(this.y-=5),this.ctx.keyIsDown(this.ctx.DOWN_ARROW)&&(this.y+=5),this.x<0&&(this.x=this.ctx.width),this.x>this.ctx.width&&(this.x=0),this.y<0&&(this.y=this.ctx.height),this.y>this.ctx.height&&(this.y=0)}killed(){this.lives--,this.invulnerable=!0,this.setSprite(this.sprites.invulnerable),setTimeout(()=>{this.setSprite(this.sprites.normal),this.invulnerable=!1},2e3)}}class S extends f{constructor(i,t,o,s,n){super(i,t,o,s,n),this.x=this.ctx.random(this.ctx.width),this.y=this.ctx.random(this.ctx.height),this.sprite.text="\u272D",this.sprite.textSize=20,this.sprite.textColor="yellow",this.sprite.color="olive"}move(i,t){if(super.move(),this.proximityTo(i)<200){let o=this.ctx.atan2(i.y-this.y,i.x-this.x);this.x+=this.ctx.cos(o)*2,this.y+=this.ctx.sin(o)*2}else for(let o of t.filter(s=>!s.killed))if(this.proximityTo(o)<200){let s=this.ctx.atan2(this.y-o.y,this.x-o.x);this.x-=this.ctx.cos(s)*2,this.y-=this.ctx.sin(s)*2;break}}}class v extends f{constructor(i,t,o,s,n){return super(i,t,o,s,n),this.sprites={normal:"\u{1F922}",dead:"\u{1FAA6}"},this.sprite.image=this.sprites.normal,this.killed=!1,this}kill(){this.killed=!0,this.sprite.image=this.sprites.dead}move(i,t,o){if(!this.killed){super.move();for(let s of i)if(this.proximityTo(s)<50){let n=this.ctx.atan2(this.y-s.y,this.x-s.x);this.x+=this.ctx.cos(n)*2,this.y+=this.ctx.sin(n)*2;break}for(let s of o)if(this.proximityTo(s)<50){let n=this.ctx.atan2(this.y-s.y,this.x-s.x);this.x+=this.ctx.cos(n)*2,this.y+=this.ctx.sin(n)*2;break}for(let s of t)if(this.proximityTo(s)<100){let n=this.ctx.atan2(s.y-this.y,s.x-this.x);this.x+=this.ctx.cos(n)*3,this.y+=this.ctx.sin(n)*3;break}}}}class w extends f{constructor(i,t,o,s,n){super(i,t,o,s,n),this.sprite.image="\u{1F603}"}move(i,t){super.move(),this.x+=this.ctx.map(this.ctx.noise(this.noiseOffsetX),0,1,-2,2),this.y+=this.ctx.map(this.ctx.noise(this.noiseOffsetY),0,1,-2,2),this.noiseOffsetX+=.001,this.noiseOffsetY+=.001,this.x<0&&(this.x=this.ctx.width),this.x>this.ctx.width&&(this.x=0),this.y<0&&(this.y=this.ctx.height),this.y>this.ctx.height&&(this.y=0);for(let o of i.filter(s=>!s.killed))if(this.ctx.dist(this.x,this.y,o.x,o.y)<50){this.x+=(this.x-o.x)*.05,this.y+=(this.y-o.y)*.05;break}this.ctx.dist(this.x,this.y,t.x,t.y)<50&&(this.x+=(this.x-t.x)*.05,this.y+=(this.y-t.y)*.05)}display(){this.sprite.x=this.x,this.sprite.y=this.y}}class A extends f{constructor(i,t,o,s,n){super(i,t,o,s,n),this.x=this.ctx.random(this.ctx.width),this.y=this.ctx.random(this.ctx.height),this.sprite.image="\u26D1",this.waiting=!1}move(i){if(!this.waiting){super.move();for(let t of i.filter(o=>!o.killed))if(this.proximityTo(t)<100){let o=this.ctx.atan2(this.y-t.y,this.x-t.x);this.x-=this.ctx.cos(o)*5,this.y-=this.ctx.sin(o)*5;break}}}wait(){this.waiting=!0,setTimeout(()=>this.waiting=!1,3e3)}}await y(()=>import("./index.db9e016b.js"),["assets/index.db9e016b.js","assets/_commonjsHelpers.88e99c8f.js"]);window.planck=await y(()=>import("./planck.21b3dc8b.js"),[]);await y(()=>import("./p5play.eb70780b.js").then(function(e){return e.p}),["assets/p5play.eb70780b.js","assets/_commonjsHelpers.88e99c8f.js"]);await y(()=>import("./sound.a1c9346d.js"),[]);let l={},_=[],x={},u={};const d="Arial";function F(e){return new Promise(i=>{setTimeout(i,e)})}new p5(e=>{e.preload=()=>{x.player={normal:e.loadImage("images/u1f635_u1f922.png"),invuln:e.loadImage("images/u1fae5_u1f922.png")},u=e.loadFont("fonts/CharriotDeluxe.ttf"),l.scream=e.loadSound("audio/64940__syna-max__wilhelm_scream.wav"),l.gunshot=e.loadSound("audio/128297__xenonn__layered-gunshot-7.wav"),l.crunch=e.loadSound("audio/524609__clearwavsound__bone-crunch.wav"),l.thing=e.loadSound("audio/425941__jarethorin__loopy-thing.wav"),l.heal=e.loadSound("audio/578581__nomiqbomi__tremolo-strings-2.mp3"),l.nomnom=e.loadSound("audio/543386__thedragonsspark__nom-noise.wav"),l.bite=e.loadSound("audio/353067__jofae__bite-cartoon-style.mp3"),l.nom=e.loadSound("audio/nom.smaller.mp3"),l.bell=e.loadSound("audio/taco-bell-bong-sfx-120135.mp3")};const i={HELP:"help",PLAYING:"playing",ROUND_OVER:"round over",PAUSED:"paused",GAME_OVER:"game over",ATTRACT:"attract"};let t={mode:i.ATTRACT,previousMode:i.ATTRACT,score:0,level:0,livesMax:3,painted:!1,humans:[],zombies:[],doctors:[],soldiers:[],player:{},gameObjs:[],doctorLimit:1,humanLimit:12,soldierLimit:2,helpObjs:[]};function o(){t.gameObjs=[t.humans,t.zombies,t.doctors,t.soldiers],t.gameObjs.forEach(r=>r.forEach(h=>h.sprite.remove())),t.humans=[],t.zombies=[],t.soldiers=[],t.doctors=[];for(let r=0;r<t.humanLimit;r++)t.humans.push(new w(e,null,null));for(let r=0;r<t.soldierLimit;r++)t.soldiers.push(new S(e,null,null,-2.5,.02));for(let r=0;r<t.doctorLimit;r++)t.doctors.push(new A(e,null,null,-2.5,.001));t.level++,t.level%2===0&&(t.soldierLimit++,t.humanLimit+=2),t.gameObjs=[t.humans,t.zombies,t.doctors,t.soldiers],t.mode=i.PLAYING}function s(){t.level=0,t.score=0,o(),t.player.sprite&&t.player.sprite.remove(),t.player=new b(e,null,null,t.livesMax,x.player),t.mode=i.PLAYING,l.thing&&(l.thing.setVolume(1),l.thing.loop())}function n(){e.fill(0),e.textSize(12),e.textAlign(e.LEFT),e.textFont(u),e.text("Score: "+t.score,10,30),e.text("Round: "+t.level,10,40),e.text(`Lives: ${t.player.lives}`,10,50),e.text(`Humans: ${t.humans.length}`,10,60),e.text(`Zombies: ${t.zombies.length}`,10,70),e.textFont(d)}async function a(){if(t.painted=!1,e.background(220),e.textFont(d),t.player.move(),t.player.display(),t.player.lives<=0){t.mode=i.GAME_OVER,l.scream.play();return}for(let r of t.humans)r.move(t.zombies,t.player),r.display(),t.player.touches(r)&&(l.bite.play(),r.sprite.remove(),t.zombies.push(new v(e,r.x,r.y)),t.humans.splice(t.humans.indexOf(r),1),t.score++);for(let r of t.zombies){r.move(t.soldiers,t.humans,t.doctors),r.display();for(let h of t.humans)r.touches(h)&&(l.nomnom.play(),h.sprite.remove(),t.zombies.push(new v(e,h.x,h.y)),t.humans.splice(t.humans.indexOf(h),1))}for(let r of t.soldiers){r.move(t.player,t.zombies),r.display(),r.touches(t.player)&&!t.player.invulnerable&&(t.player.killed(),l.gunshot.play());for(let h of t.zombies.filter(m=>!m.killed))r.touches(h)&&(l.gunshot.play(),h.kill())}for(let r of t.doctors){r.move(t.zombies),r.display();for(let h of t.zombies.filter(m=>!m.killed))!r.waiting&&r.touches(h)&&(r.wait(),l.heal.play(),h.sprite.remove(),t.humans.push(new w(e,h.x,h.y)),t.zombies.splice(t.zombies.indexOf(h),1))}t.humans.length===0&&(t.mode=i.ROUND_OVER,l.bell.play(),await F(1e3),o()),n()}e.setup=()=>{let r=e.createCanvas(600,600);e.frameRate(30),e.noStroke(),e.textStyle(e.BOLD),e.textFont(d);let h=e.createButton("Start");h.position(r.offsetLeft,r.offsetTop+r.offsetHeight+10),h.mousePressed(s)},e.mousePressed=()=>{t.mode===i.ATTRACT&&s()};function g(){e.kb.pressed("p")||e.kb.pressed(" ")?t.mode===i.PLAYING?p():t.mode===i.PAUSED&&k():e.kb.pressed("h")?t.mode===i.HELP?(t.mode=t.previousMode,P()):(t.previousMode=t.mode,t.mode=i.HELP,t.painted=!1):t.mode===i.GAME_OVER&&s()}const p=()=>{t.mode=i.PAUSED},k=()=>{t.mode=i.PLAYING,t.painted=!1},T=()=>{t.gameObjs.forEach(r=>r.forEach(h=>h.sprite.visible=!1)),t.player.sprite.visible=!1},L=()=>{t.gameObjs.forEach(r=>r.forEach(h=>h.sprite.visible=!0)),t.player.sprite.visible=!0},R=()=>{T(),e.clear(),e.background(220),e.fill(0),e.textSize(32),e.textAlign(e.CENTER),e.textFont(d);let r=new w(e,70,100),h=new S(e,70,130),m=new v(e,70,160),z=new A(e,70,190),O=new b(e,70,220,3,x.player),c=new b(e,70,250,3,x.player);c.invulnerable=!0,c.setSprite(c.sprites.invulnerable),O.display(),c.display(),_=[r,h,m,z,O,c],e.textAlign(e.LEFT),e.textSize(16),e.textFont(u),e.text("Human: tasty!",100,105),e.text("Soldier: beware!",100,135),e.text("Zombie: your babies! (you can ignore them now)",100,165),e.text("Doctor: No worries, but heals zombies back to life",100,195),e.text("Player: Move with arrow keys, bite humans, avoid soldiers",100,225),e.text("Player: after being shot and returning to un-life, you are briefly invulnerable",100,255,300),e.textFont(d),t.painted=!0},P=()=>{_.forEach(r=>r.sprite?.remove()),_=[],L(),t.painted=!1};e.draw=()=>{if(g(),t.mode!==i.ROUND_OVER){if(t.mode===i.ATTRACT){G(e);return}if(t.mode===i.PAUSED&&!t.painted){t.painted=!0,e.background(0,50),e.fill(255),e.textSize(32),e.textAlign(e.CENTER),e.textFont(u),e.text("Paused",e.width/2,e.height/2),e.text("Press 'p' or 'space' to continue",e.width/2,e.height/2+50),e.textFont(d);return}if(t.mode===i.GAME_OVER&&!t.painted){t.painted=!0,e.background(0,50),e.fill(255),e.textSize(32),e.textAlign(e.CENTER),e.textFont(u),e.text("Game Over",e.width/2,e.height/2);return}if(t.mode===i.HELP&&!t.painted){R();return}t.mode===i.PLAYING&&a()}}});function G(e){e.background(0),e.textAlign(e.CENTER),e.textFont(u),e.textSize(40),e.textStyle(e.BOLD),e.fill(e.random(255),e.random(255),e.random(255)),e.text("Nova Zombie Simulator",e.width/2,e.height/2-100),e.textStyle(e.NORMAL),e.fill(255),e.textSize(32),e.text("Click to Start",e.width/2,e.height/2+50),e.textSize(18),e.text("by Michael and Anthony Paulukonis",e.width/2,e.height/2+200),e.textFont(d)}
